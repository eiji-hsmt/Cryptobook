## RSA暗号

RSA暗号はもっとも古い公開鍵暗号で、1974年頃にイギリスの諜報機関GHCQのJ.エリスらが考案した暗号方式です。もっとも、それは国家機密として公となることはなく、RSA暗号は1977年に独自に再発見したRivest, Shamir, Adlemanのイニシャルからとって命名されています。RSA暗号のアルゴリズムは次の通りです。

相異なる素数$$p, q$$ \(できれば桁数がほぼ同じで、かつ $$gcd(p-1, q-1)=2$$となるものが好ましいとされている\) を生成し、整数 $$(p-1)(q-1)$$ と互いに素な整数 $$e$$ を選び、
$$
de \equiv 1 \pmod{(p-1)(q-1)}
$$
を満たす整数 $$d$$ を求めておく。このような整数$$d$$の存在は、ベズーの補題によって保証され、拡張ユークリッド互除法 \(多項式時間アルゴリズム\) で求めることができる。 $$n := pq$$ \(RSAモジュールとよぶ\) として、 $$(n, e)$$ を公開鍵として公開する。 $$d$$ は秘密鍵として使用し、 $$p, q$$ は秘密にしておく。

暗号化するときは、平文 $$m$$ に対して、
$$
m^e \mod{n}
$$
を計算して、これを暗号文とする。

秘密鍵$$d$$をもっている人が、平文$$m$$の暗号文$$m^e$$を復号するときは、これを$$d$$乗する。すると、
$$
m^{ed} \equiv m \pmod{n}
$$
となって、平文を復号できる。

復号がこのようにうまくいくことは、 \(平文$$m$$が$$n$$と公約数をもつ場合を除いては\) フェルマーの小定理を一般化したオイラーの定理によって説明できる。

オイラーの定理によれば、$$m^{(p-1)(q-1)} \equiv 1 \pmod{pq}$$ である.

ところで、$$ed \equiv 1 \pmod{(p-1)(q-1)}$$ の意味するところは、「$$ed$$を$$(p-1)(q-1)$$で割ると$$1$$余る」なのだから、ある整数$$k$$があって、

$$
ed = (p-1)(q-1)k + 1
$$

である。

よって、

$$
m^{ed} = m^{(p-1)(q-1)k+1} = (m^{(p-1)(q-1)})^k \cdot m \equiv 1^k \cdot m \equiv m \pmod{n (=pq)}
$$

となり、復号できることが確かめられる。

この説明がうまくいくのは、オイラーの定理の制約により、$$m$$と$$pq$$が$$1$$以外の公約数をもたない場合、すなわち、$$m$$が$$p$$の倍数でもなければ$$q$$の倍数でもない場合に限る。オイラーの定理で説明できないケースについても、次に示す通り, 中国の剰余定理によって正しく復号できることが保証される。
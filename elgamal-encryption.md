## 公開鍵暗号ってなんだっけ

公開鍵暗号は鍵生成、暗号化、復号のアルゴリズムの組として表されます。

公開鍵暗号の鍵生成アルゴリズムは、誰にも公開しない秘密鍵$$SK$$と、通信したいすべての人に公開する公開鍵$$PK$$を生成します \($$SK \ne PK$$とする。\) 暗号化アルゴリズム$$Enc$$は公開鍵$$PK$$を使って、平文$$m$$から暗号文$$c :=Enc(PK, m)$$を作ります。復号アルゴリズム$$Dec$$は秘密鍵$$SK$$を使って、暗号文$$c$$から平文$$m := Dec(SK, c)$$を復号します。

このように、暗号化の際に使用する鍵$$PK$$と復号に使用する鍵$$SK$$が異なるため、非対称暗号 \(asymmetric cipher\) とよばれることもあります。

暗号化に使用する鍵 $$PK$$ は公開情報であって、暗号化アルゴリズム $$Enc$$ も公開情報ですので、公開鍵暗号の安全性を考える場合には、攻撃者は選択平文攻撃 \(CPA\) 以上の攻撃が可能であることを常に想定しなければなりません。すなわち、暗号の用に供するためには、少なくとも IND-CPA \(選択平文攻撃での識別不可能性\) を証明できる必要があります。

## ElGamal暗号

ElGamal暗号は、公開鍵暗号の一方式であり、$$GF(p)$$の $$0$$ を除いて乗法に関してなす群の要素から生成される巡回群を利用します。具体的には次のような方式です。

1. Diffie-Hellman鍵共有と同様に、まずは、素数$$p$$と適当な $$g \in (\mathbb{Z}/p\mathbb{Z})^{\times}$$ を生成して公開しておきます
2. 次に鍵生成を行います。整数 $$x$$ をランダムに選び、 $$g^x$$ を生成します。$$x$$ を秘密鍵、$$g^x$$ を公開鍵とし、 $$g^x$$ は公開します
3. 公開鍵 $$g^x$$ をもつ人は、乱数$$r$$ を生成して $$g^r$$ を計算してから、平文$$m$$ に対して $$(g^r, mg^{xr})$$ というペアを計算し、これを暗号文とします
4. 秘密鍵 $$x$$ をもつ人は、暗号文 $$(g^r, mg^{xy})$$ を受け取ったのちに、$$(g^r)^x = g^{xr}$$ を計算し、この$$g^{xy}$$ で $$mg^{xy}$$ を割ります。すると、$$\frac{mg^{xy}}{g^{xy}}=m$$ となり、復号することができます

もしも$$g, p, g^x$$から$$x$$を逆算できた場合には、これらは公開情報でしたから、盗聴者を含め誰でも秘密鍵を計算で求めることができ、よって暗号化のみならず復号まで自由にできてしまいます。言い換えると、もしも離散対数問題が解けるならば、秘密鍵を復元する \(こういった攻撃を、鍵復元攻撃 \(key recovery attack\) という\) ことが可能となって、ElGamal暗号は安全ではなくなります。

### ElGamal暗号の安全性


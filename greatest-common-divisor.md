## 最大公約数とベズーの補題

### 約数

整数$$a, d$$に対して, ある整数$$k$$があって$$a=kd$$であるとき, $$d$$は$$a$$の約数である, または$$d$$は$$a$$を割り切るという. $$d | a$$で表す.

なお, 「ある$$x$$があって, $$\cdots$$」という表現は, 「$$\cdots$$ を満たすような $$x$$ をうまく選ぶことができる」くらいの意味である.

**例** $$\hspace{10pt}3\ |\ 9$$, $$-7\ |\ 21$$

実際, $$3, 9$$に対して, $$k$$として$$k=3$$を選ぶことで$$9=k\cdot 3$$にできる. $$-7, 21$$についても同様である.

### 最大公約数

整数$$a, b$$の各々の約数のうち, 共通のものを公約数という. 公約数のうちで最大のものを最大公約数 \(greatest common divisor\) といい, $$gcd(a, b)$$ で表す.

**例** $$\hspace{10pt}gcd(12,16)=4$$

$$12$$の約数は, すなわち$$12$$を割り切ることのできる整数は$$12, 6, 4, 3, 2, 1, -1, -2, -3, -4, -6, -12$$であり, $$16$$の約数は$$16, 8, 4, 2, 1, -1, -2, -4, -8, -16$$であるから, 共通する約数は$$4, 2, 1, -1, -2, -4$$である. この中で最大のものは $$4$$ であるから, $$gcd(12, 16)=4$$である.

### 倍数

$$k$$に対して, $$k | n$$となる整数$$n$$のことを$$k$$の倍数という. たとえば, $$11$$に対して, $$11 | 33$$となるので, $$33$$は$$11$$の倍数である.

整数の集合をしばしば$$\mathbb{Z}$$で表すが, $$k$$の倍数の集合を $$k\mathbb{Z}$$ と表す.

たとえば,

$$
\begin{align}
2\mathbb{Z}=\{\cdots , -6, -4, -2, 0, 2, 4, 6, \cdots \} \\\
3\mathbb{Z}=\{\cdots , -9, -6, -3, 0, 3, 6, 9, \cdots \}
\end{align}
$$

である.


### 整数の除法の一意性

**定理** 任意の整数 $$a, b$$ に対して, ある整数 $$q, r$$ が存在して,

$$a = qb + r, 0 \le r \lt b$$

となる. このような $$q, r$$ は任意に選んだ $$a, b$$ に対してただ一つだけ存在する.

**証明** うまく$$q, r$$を選ぶことで$$a=qb+r$$と表せることを証明したのちに, そのような表現が一通りしか存在しないことを示す.

$$a < b$$のとき, $$q, r$$として$$q = 0, r = a$$を選べば, $$a = qb + r$$と表すことができる.

$$a \ge b$$のとき, $$a$$ がいかに大きかったとしても, 十分大きな自然数$$k$$をとることで, $$a \lt kb$$ とすることができる. \(例として, $$1000000000 \ge 2$$ だが $$500000001$$ という自然数をとることによって, $$1000000000 \lt 2 \cdot 500000001 = 1000000002$$ とできる.\)

$$a \lt kb$$を満たす$$k$$の最小の値を$$q+1$$とおく. すると,

$$
a \lt (q+1)b \\\
a \ge qb
$$

であるから, すなわち $$a$$ は $$qb$$ 以上 $$(q+1)b$$ 未満の値であって $$qb, qb+1, \cdots , qb + (b - 1)$$ のいずれかであるから,

$$
a = qb + r, \hspace{10pt} 0 \le r \lt b
$$

と表すことができる.

次に一意性を証明する.

任意の $$a, b$$に対して, ２通りの割り算の仕方, $$a = qb + r = q^{\prime}b+r^\prime$$ が可能と仮定する.

$$
\begin{align}
a &= qb + r \\\
a &= q^{\prime}b + r^\prime
\end{align}
$$

の辺々引いて,

$$
\begin{align}
&0 = (qb + r) - (q^{\prime} b + r^\prime ) \\\
\Leftrightarrow \ &0 = (q - q^{\prime})b + (r - r^\prime ) \\\
\Leftrightarrow \ &(q - q^{\prime})b = -(r - r^\prime )
\end{align}
$$

$$q \ne q^\prime$$ であるならば, $$(q - q^\prime ) \ne 0 $$ であるから, $$r - r^\prime$$ は$$b$$の倍数でなければならない. 

$$r - r^\prime$$ は, $$0 \le r, r^\prime \lt b$$ であるから,

$$
-b \lt r - r^\prime \lt b
$$

となるが \(わかりにくければ, 数直線上に$$0, b$$をとって, $$r, r^\prime$$をその区間にプロットしてみればよい. $$r - r^\prime$$ はプロットした2点間の \(符号付きの\) 距離と考えられるから, $$-b$$ 以下にはなりえないし, $$b$$以上にもなりえない,\) bの倍数 $$\{ \cdots , -3b, -2b, -b, 0, b, 2b, 3b, \cdots \}$$ のうち, $$-b \lt r - r^\prime \lt b$$ を満たす数は $$0$$ しか存在しないため, $$r - r^\prime = 0$$ すなわち $$r = r^\prime$$ となるが, このとき右辺が $$0$$ となり かつ 左辺が $$0$$ とならないため不適.

よって $$q = q^\prime $$ である.

$$q = q^\prime$$ であるならば, 

$$
\begin{align}
&\ qb + r = q^{\prime}b + r^\prime \\\
\Leftrightarrow &\ qb + r = qb + r^\prime \\\
\Leftrightarrow &\ r = r^\prime
\end{align}
$$

となるので, 結局 $$q = q^\prime, r = r^\prime$$ となってしまい, 異なる２通りの表現 (割り算の仕方) は存在しない, すなわち表現はただ一つしか存在しない ■

この $$q$$ を商, $$r$$ を剰余 \(あまり\) という. 定理は割り算の仕方が一通りしかないことを主張している.

**例** 整数 $$23, 9$$ に対して, 整数 $$2, 5$$ が存在して,


$$
23 = 2\cdot 9 + 5, 0 \le 5 \lt 9
$$


である. $$23$$を$$9$$で割ったとき, 商がこれ以外になることはありえないし, 余りが$$5$$以外になることもありえない.

### ベズーの補題

整数$$m, n$$に対して, $$m$$の倍数と$$n$$の倍数の足し算で表現できる全ての数の集合を $$m\mathbb{Z}+n\mathbb{Z}$$ と表す.

たとえば, $$4\mathbb{Z}+6\mathbb{Z}$$は,

$$
4\mathbb{Z}+6\mathbb{Z} = \{\cdots , -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, \cdots \}
$$

である. 実際, これらの数は下に示す通り, $$4$$の倍数と$$6$$の倍数の足し算で表現できる.

$$
\begin{align}
\cdots\\\
-10 &= 4 \cdot (-1) + 6 \cdot (-1) \\\
 -8 &= 4 \cdot (-2) + 6 \cdot 0 \\\
 -6 &= 4 \cdot 0    + 6 \cdot (-1) \\\
 -4 &= 4 \cdot (-1) + 6 \cdot 0 \\\
 -2 &= 4 \cdot 1    + 6 \cdot (-1) \\\
  0 &= 4 \cdot 0    + 6 \cdot 0 \\\
  2 &= 4 \cdot (-1) + 6 \cdot 1 \\\
  4 &= 4 \cdot 1    + 6 \cdot 0 \\\
  6 &= 4 \cdot 0    + 6 \cdot 1 \\\
  8 &= 4 \cdot 2    + 6 \cdot 0 \\\
 10 &= 4 \cdot 1    + 6 \cdot 1 \\\
\cdots
\end{align}
$$

これは, $$4$$と$$6$$の最大公約数である$$2$$の倍数の集合 $$2\mathbb{Z}$$と等しそうである. この予想は正しいだろうか.

**定理** 任意の整数$$a, b$$に対して, ある整数$$x, y$$が存在して,

$$
ax+by=gcd(a, b)
$$

**証明** $$I=a\mathbb{Z}+b\mathbb{Z}$$ とおく.

$$I$$の正の最小の要素を$$d$$とすると, 任意の$$x \in I$$について, 整数の除法の一意性により


$$
x=qd+r, 0 \le r \lt d
$$


を満たす$$q, d$$が一意に存在する.

$$d$$ は $$I$$ の要素なのだから, 適当な $$y, z$$ があって,


$$
d=ay+bz
$$


と表すことができる. ゆえに, 両辺の左から $$q$$ をかけることにより,


$$
\begin{align}  
&qd = q\cdot (ay + bz) \\\
\Leftrightarrow \ &qd =q\cdot ay + q\cdot bz \hspace{12pt}(分配律) \\\
\Leftrightarrow \ &qd =a\cdot qy+b\cdot qz \in I \\\
&(交換律. また, 明らかに qy \in \mathbb{Z}, qz \in \mathbb{Z} である) \\\
\end{align}
$$


$$x=qd+r$$ の両辺の左から $$-qd$$ を加えることによって,


$$
\begin{align}  
&-qd+x=-qd+qd+r \\\
\Leftrightarrow \ &-qd + x = 0 + r = r \\\
\Leftrightarrow \ &x + (-qd) = r \\\
&(整数の加法は可換なので, \\\
&-qd と x の和は入れ替えられる)  
\end{align}
$$


この左辺は, $$x \in I$$ および $$-qd \in I$$ より,いずれも$$as + bt$$,$$as^{\prime} +bt^{\prime}$$ のように表せるのだから,  
その和もまた $$as^{\prime \prime} + bt^{\prime \prime}$$ のように表せる. ゆえに,


$$
(左辺) \in I
$$


であり, したがって,


$$
(右辺)=r \in I
$$


である.

$$0 \lt r \lt d$$ を仮定すると, $$d$$ の最小性の仮定に矛盾するため, $$r = 0$$ である.

以上より, 任意の $$x \in I$$ は,


$$
x \in d \mathbb{Z} = \{ \cdots , -3d, -2d, -d, 0, d, 2d, 3d, \cdots \}
$$


このことは, すべての $$x \in I $$ に対して,


$$
\begin{align}  
d\ |\ x \hspace{20pt} (d は x の約数)  
\end{align}
$$


であることを意味している.


$$
\begin{align}  
a &= a \cdot 1 + b \cdot 0 \in I \\\
b &= a \cdot 0 + b \cdot 1 \in I  
\end{align}
$$


であるから, $$d | a$$ かつ $$d | b$$ すなわち $$d$$ は $$a, b$$ の公約数であり, すべての公約数は最大公約数の約数であるから,


$$
d\ |\ gcd(a, b)
$$


ところで, $$d \in I$$ より, ある$$y, z$$があって, $$d = ay + bz$$ と表せるのであった.

公約数の定義から, $$gcd(a, b) | a$$ かつ $$gcd(a, b) | b$$ なのだから,


$$
gcd(a, b)\ |\ ay + bz = d
$$


ゆえに,


$$
d\ |\ gcd(a, b) \hspace{16pt} かつ \hspace{16pt} gcd(a, b)\ |\ d
$$


が得られ, このことから,


$$
d = gcd(a, b)
$$

よって,


$$
x \in I \Rightarrow x \in gcd(a, b)\mathbb{Z}
$$

逆
に, $$x \in gcd(a, b)\mathbb{Z}$$ であれば $$x \in I$$である.

というのも, $$d (=gcd(a, b))$$ は $$I$$ の要素なのだから, うまく$$x, y$$を選べば$$d = ax + by$$ とすることができる. ゆえに $$z \in gcd(a, b)\mathbb{Z}$$ であれば, ある$$k$$があって

$$
\begin{align}
z &= k \cdot gcd(a, b) = k \cdot (ax + by) \\\
&= a\cdot kx + b \cdot ky \in I
\end{align}
$$

以上より,

$$x \in I$$ であれば $$x \in gcd(a, b)\mathbb{Z}$$ であり, かつ, $$x \in gcd(a, b)\mathbb{Z}$$ であれば $$x \in I$$ である.

したがって, $$I = gcd(a, b)\mathbb{Z}$$ である.

換言すると, $$I$$ に属する数の中には, 必ず $$gcd(a, b) = 1\cdot gcd(a, b) \in gcd(a, b)\mathbb{Z}$$ と等しいものが存在する.

このことは, 任意の $$a, b$$ に対して, うまく $$x, y$$ を選ぶことで, $$ax + by = gcd(a, b)$$ にできることを意味している ■
## 最大公約数とベズーの補題

### 約数

整数$$a, d$$に対して、ある整数$$k$$があって$$a=kd$$となるとき、$$d$$は$$a$$の約数である、または$$d$$は$$a$$を割り切るといいます。これを、$$d\ |\ a$$で表します。

ここで、「ある$$x$$があって、$$\cdots$$」という表現は、「$$\cdots$$ を満たすような $$x$$ をうまく選ぶことができる」くらいの意味です。かたっくるしい言い回しですが、慣れてしまえばどうってことはありません。例をみてみましょう。

**例** $$\hspace{10pt}3\ |\ 9$$, $$-7\ |\ 21$$

$$3, 9$$に対して、$$k$$として$$k=3$$を選ぶことで$$9=k\cdot 3$$にできますね。「$$d$$は$$a$$の約数である」の言い換えは「$$a$$を$$d$$で割り切ることができる」です。実際に、$$9$$を$$3$$で割り切ることができて商は$$k (=3)$$となると言っても同じことですね。$$-7, 21$$についても同様です。

### 最大公約数

整数$$a, b$$の各々の約数のうち、共通のものを公約数といいます。公約数のうちで最大のものを最大公約数 \(greatest common divisor\) といって、$$gcd(a, b)$$ で表します。

**例** $$\hspace{10pt}gcd(12,16)=4$$

約数というのは割り切ることのできる数のことでしたから、$$12$$の約数は、つまり$$12$$を割り切ることのできる整数を並べてみると、

$$
-12, -6, -4, -3, -2, -1, 1, 2, 3, 4, 6, 12
$$

ですね。おなじようにして、$$16$$の約数を並べてみると、

$$
-16, -8, -4, -2, -1, 1, 2, 4, 8, 16
$$

となりますから、これらから共通する部分を取り出してみると、

$$
4, 2, 1, -1, -2, -4
$$

ですね。これが公約数です。

この中で最大のものは $$4$$ ですので、$$12$$と$$16$$の最大公約数は $$4$$ です。$$gcd(12, 16)=4$$ で表します。

### 互いに素

ふたつの整数$$a,b$$が、$$1, -1$$以外の公約数をもたないとき、「$$a,b$$は互いに素ある」といいます。このことは、最大公約数が$$1$$であると言い換えても良いです。つまり、

$$
gcd(a,b)=1
$$

と「$$a,b$$は互いに素である」は同じことを言っています。

**例** $$4$$と$$9$$は互いに素である.

$$4$$の約数は

$$
-4, -2, -1, 1, 2, 4
$$

で、$$9$$の約数は

$$
-9, -3, -1, 1, 3, 9
$$

ですね。共通する約数、つまり公約数は

$$
-1, 1
$$

だけです。なので、$$4$$と$$9$$は互いに素ですね。このとき、最大公約数は$$1$$、記号で表すと $$gcd(4,9)=1$$になっているのも確認できると思います。

### 倍数

$$k$$に対して、$$k | n$$となる整数$$n$$のことを$$k$$の倍数といいます。ちょっとややこしいですか？「$$k$$の倍数とは$$k$$で割り切ることのできる数のことである」ということですよ。たとえば、$$11$$に対して, $$11 | 33$$ \($$33$$は$$11$$で割り切れる\) となるので、$$33$$は$$11$$の倍数です。

整数の集合を$$\mathbb{Z}$$で表しますが、$$k$$の倍数の集合は $$k\mathbb{Z}$$ と表します。

たとえば、

$$
\begin{align}
2\mathbb{Z}=\{\cdots , -6, -4, -2, 0, 2, 4, 6, \cdots \} \\\
3\mathbb{Z}=\{\cdots , -9, -6, -3, 0, 3, 6, 9, \cdots \}
\end{align}
$$

です。

### 整数の除法の一意性

約数について説明する際に、「$$n$$が$$d$$で割り切れるとき \(= $$d$$が$$n$$の約数であるとき\)、ある整数$$k$$が存在して、$$n=kd$$を満たす」というようなまわりくどい言い回しをしましたが、これの言い換えとして、「$$n$$を$$d$$で割ってみて、余りがでないときは、$$n=kd$$と書ける \(表せる\)」と言い直しても良いことがわかります。

割り切れない場合、つまり余りが$$0$$でない場合はどうでしょうか。たとえば、$$11$$を$$3$$で割ると、商$$3$$となり、余りは$$2$$となります。割られる数が余りの$$2$$だけ小さければ割り切れたはずなので、

$$
11-2=3\cdot 3
$$

と表せます。$$2$$を移項すると

$$
11=3\cdot 3 + 2
$$

となります。一般に、$$a$$を$$b$$で割ったとき、商と余りをそれぞれ$$q, r$$として、

$$
a=bq+r
$$

と表すことができます。

ところで、$$11$$を$$3$$で割る場合、商
$$3$$以外になることはありえないし、余りが$$2$$以外になることはありませんね。何をあたりまえなことを言っているのだ、と思ってしまうところですが、これはどんな整数$$a,b$$についても一般に言えることなのでしょうか。これを肯定するのが次の定理です。

**定理** 任意の整数 $$a, b$$ に対して, ある整数 $$q, r$$ が存在して,

$$a = qb + r, 0 \le r \lt b$$

となる. このような $$q, r$$ は任意に選んだ $$a, b$$ に対してただ一つだけ存在する.

**証明** うまく$$q, r$$を選ぶことで$$a=qb+r$$と表せることを証明したのちに, そのような表現が一通りしか存在しないことを示す.

$$a < b$$のとき, $$q, r$$として$$q = 0, r = a$$を選べば, $$a = qb + r$$と表すことができる.

$$a \ge b$$のとき, $$a$$ がいかに大きかったとしても, 十分大きな自然数$$k$$をとることで, $$a \lt kb$$ とすることができる. \(例として, $$1000000000 \ge 2$$ だが $$500000001$$ という自然数をとることによって, $$1000000000 \lt 2 \cdot 500000001 = 1000000002$$ とできる.\)

$$a \lt kb$$を満たす$$k$$の最小の値を$$q+1$$とおく. すると,

$$
a \lt (q+1)b \\\
a \ge qb
$$

であるから, すなわち $$a$$ は $$qb$$ 以上 $$(q+1)b$$ 未満の値であって $$qb, qb+1, \cdots , qb + (b - 1)$$ のいずれかであるから,

$$
a = qb + r, \hspace{10pt} 0 \le r \lt b
$$

と表すことができる.

次に一意[^1]性を証明する.

[^1]: uniqueの訳語で、「ただ一つ \(一通り\) だけ存在すること」を意味します。

任意の $$a, b$$に対して, ２通りの割り算の仕方, $$a = qb + r = q^{\prime}b+r^\prime$$ が可能と仮定する.

$$
\begin{align}
a &= qb + r \\\
a &= q^{\prime}b + r^\prime
\end{align}
$$

の辺々引いて[^2],

$$
\begin{align}
&0 = (qb + r) - (q^{\prime} b + r^\prime ) \\\
\Leftrightarrow \ &0 = (q - q^{\prime})b + (r - r^\prime ) \\\
\Leftrightarrow \ &(q - q^{\prime})b = -(r - r^\prime )
\end{align}
$$

$$q \ne q^\prime$$ であるならば, $$(q - q^\prime ) \ne 0 $$ であるから, $$r - r^\prime$$ は$$b$$の倍数でなければならない. 

$$r - r^\prime$$ は, $$0 \le r, r^\prime \lt b$$ であるから,

$$
-b \lt r - r^\prime \lt b
$$

となる[^3]が, $$b$$ の倍数 $$\{ \cdots , -3b, -2b, -b, 0, b, 2b, 3b, \cdots \}$$ のうち, $$-b \lt r - r^\prime \lt b$$ を満たす数は $$0$$ しか存在しないため, $$r - r^\prime = 0$$ すなわち $$r = r^\prime$$ となるが, このとき右辺が $$0$$ となり かつ 左辺が $$0$$ とならないため不適.

[^2]: 「辺々引いて」は、「左辺同士、右辺同士で引き算をして」くらいの意味です。一般に$$a=b$$と$$c=d$$という2つの式があったとき、辺々引いたものも等式が成立し、$$a-c=b-d$$となります。イコールの意味を考えれば、もっともかと思います。

[^3]: わかりにくければ, 数直線上に$$0, b$$をとって, $$r, r^\prime$$をその区間にプロットしてみればよいでしょう. $$|r - r^\prime |$$ はプロットした2点間の距離と考えられるから, $$-b \lt r - r^\prime \lt b$$となります。

よって $$q = q^\prime $$ である.

$$q = q^\prime$$ であるならば, 

$$
\begin{align}
&\ qb + r = q^{\prime}b + r^\prime \\\
\Leftrightarrow &\ qb + r = qb + r^\prime \\\
\Leftrightarrow &\ r = r^\prime
\end{align}
$$

となるので, 結局 $$q = q^\prime, r = r^\prime$$ となってしまい, 異なる２通りの表現 (割り算の仕方) が存在するという仮定が誤っていたことがわかる. すなわち表現はただ一つしか存在しない ■

上でも述べましたが、この定理は、「どんな2つの整数を選んでも、一方を他方で割ることができる」ことと、「割り算の仕方が一通りしかない \(商と余りは一通りに定まる\)」ことを主張していると言えます。

**例** 整数 $$23, 9$$ に対して, 整数 $$2, 5$$ が存在して,


$$
23 = 2\cdot 9 + 5, 0 \le 5 \lt 9
$$


となります。 $$23$$を$$9$$で割ったとき、商がこれ以外になることはありえませんし、余りが$$5$$以外になることも考えられません。